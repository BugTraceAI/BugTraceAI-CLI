INFO     Memory: Embedding model loaded   manager.py:49
         (all-MiniLM-L6-v2)                            
INFO     Conductor V2 initialized       conductor.py:84
         (Anti-Hallucination Enhanced)                 
INFO     Validation: DISABLED, Min      conductor.py:85
         Confidence: 0.6, FP Detection:                
         ON                                            
INFO     Event Bus initialized          event_bus.py:50
2026-01-14 09:10:07.314 | INFO     | bugtrace.agents.base:_load_system_prompt:73 - [JWTAgent] Loaded external prompt: system_prompts/jwt_agent.md
2026-01-14 09:10:07.315 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: jwt
2026-01-14 09:10:07.315 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: vulnerabilities
2026-01-14 09:10:07.315 | INFO     | bugtrace.agents.jwt_agent:_setup_event_subscriptions:32 - [JWTAgent] Subscribed to 'auth_token_found' events.
2026-01-14 09:10:07.315 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üîç Starting token discovery for http://127.0.0.1:5090/jwt/level0

======================================================================
JWT AGENT TESTING
======================================================================

üîç Testing Level 0: Trivial - No validation
   URL: http://127.0.0.1:5090/jwt/level0
INFO     Browser started successfully.    browser.py:45
2026-01-14 09:10:07.979 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/jwt/level0
2026-01-14 09:10:08.554 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: No tokens found on target. Trying landing page: http://127.0.0.1:5090/
2026-01-14 09:10:08.555 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/
2026-01-14 09:10:09.142 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üéØ Discovered token at link_param: eyJ0eXAiOiJKV1QiLCJh...
2026-01-14 09:10:09.142 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Token Analysis: Alg=none, Claims=['role']
INFO     LLM Shift Success: Using     llm_client.py:189
         google/gemini-3-flash-previe                  
         w for JWT_AGENT                               
2026-01-14 09:10:13.300 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 1. Base64Url encode the Header: `{"typ": "JWT", "alg": "none"}`
2026-01-14 09:10:13.304 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:13.305 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Content-based success: Found 'admin' in response
2026-01-14 09:10:13.305 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: SUCCESS: 'none' algorithm bypass confirmed with alg=none
2026-01-14 09:10:13.305 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 2. Base64Url encode the Payload: `{"role": "admin"}`
2026-01-14 09:10:13.305 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 3. Concatenate the encoded Header and Payload with a dot (`.`).
2026-01-14 09:10:13.305 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 4. Append a final dot (`.`) to represent the empty signature.
2026-01-14 09:10:13.305 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 5. Construct the final URL with the forged token in the `link_param` parameter.
2026-01-14 09:10:14.307 | INFO     | bugtrace.agents.base:_load_system_prompt:73 - [JWTAgent] Loaded external prompt: system_prompts/jwt_agent.md
2026-01-14 09:10:14.307 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: jwt
2026-01-14 09:10:14.307 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: vulnerabilities
2026-01-14 09:10:14.307 | INFO     | bugtrace.agents.jwt_agent:_setup_event_subscriptions:32 - [JWTAgent] Subscribed to 'auth_token_found' events.
2026-01-14 09:10:14.308 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üîç Starting token discovery for http://127.0.0.1:5090/jwt/level2
2026-01-14 09:10:14.366 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/jwt/level2
2026-01-14 09:10:14.921 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: No tokens found on target. Trying landing page: http://127.0.0.1:5090/
2026-01-14 09:10:14.921 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/
2026-01-14 09:10:15.506 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üéØ Discovered token at link_param: eyJ0eXAiOiJKV1QiLCJh...
2026-01-14 09:10:15.506 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Token Analysis: Alg=none, Claims=['role']
   ‚úÖ PASSED - Found JWT vuln in 6.0s
   Type: 

üîç Testing Level 2: Easy - Algorithm confusion
   URL: http://127.0.0.1:5090/jwt/level2
INFO     LLM Shift Success: Using     llm_client.py:189
         google/gemini-3-flash-previe                  
         w for JWT_AGENT                               
2026-01-14 09:10:18.545 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 1. Base64Url encode the header: `{"typ": "JWT", "alg": "none"}`.
2026-01-14 09:10:18.550 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:18.550 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Content-based success: Found 'admin' in response
2026-01-14 09:10:18.550 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: SUCCESS: 'none' algorithm bypass confirmed with alg=none
2026-01-14 09:10:18.550 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 2. Base64Url encode the payload: `{"role": "admin"}`.
2026-01-14 09:10:18.550 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 3. Concatenate the encoded header and payload with a dot (`.`).
2026-01-14 09:10:18.550 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 4. Append a trailing dot (`.`) to represent the empty signature.
2026-01-14 09:10:18.550 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 5. Inject the resulting string into the `link_param` URL parameter.
2026-01-14 09:10:18.550 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 6. Observe if the application grants administrative access.
2026-01-14 09:10:19.552 | INFO     | bugtrace.agents.base:_load_system_prompt:73 - [JWTAgent] Loaded external prompt: system_prompts/jwt_agent.md
2026-01-14 09:10:19.552 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: jwt
2026-01-14 09:10:19.552 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: vulnerabilities
2026-01-14 09:10:19.552 | INFO     | bugtrace.agents.jwt_agent:_setup_event_subscriptions:32 - [JWTAgent] Subscribed to 'auth_token_found' events.
2026-01-14 09:10:19.553 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üîç Starting token discovery for http://127.0.0.1:5090/jwt/level4
2026-01-14 09:10:19.604 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/jwt/level4
2026-01-14 09:10:20.161 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: No tokens found on target. Trying landing page: http://127.0.0.1:5090/
2026-01-14 09:10:20.161 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/
2026-01-14 09:10:20.745 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üéØ Discovered token at link_param: eyJ0eXAiOiJKV1QiLCJh...
2026-01-14 09:10:20.746 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Token Analysis: Alg=none, Claims=['role']
   ‚úÖ PASSED - Found JWT vuln in 4.2s
   Type: 

üîç Testing Level 4: Medium - Weak secret
   URL: http://127.0.0.1:5090/jwt/level4
INFO     LLM Shift Success: Using     llm_client.py:189
         google/gemini-3-flash-previe                  
         w for JWT_AGENT                               
2026-01-14 09:10:23.994 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 1. Encode the header `{"typ": "JWT", "alg": "none"}` into Base64Url.
2026-01-14 09:10:23.998 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:24.002 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:24.006 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:24.009 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:24.012 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:24.016 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:24.019 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:24.028 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:24.028 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 2. Encode the payload `{"role": "admin"}` into Base64Url.
2026-01-14 09:10:24.028 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 3. Concatenate the encoded header and payload with a dot (`.`).
2026-01-14 09:10:24.028 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 4. Append a final dot (`.`) at the end to represent the empty signature (Header.Payload.).
2026-01-14 09:10:24.028 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 5. Inject the resulting string into the `link_param` parameter of the target URL.
2026-01-14 09:10:24.028 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 6. Observe if the application grants administrative access.
2026-01-14 09:10:25.030 | INFO     | bugtrace.agents.base:_load_system_prompt:73 - [JWTAgent] Loaded external prompt: system_prompts/jwt_agent.md
2026-01-14 09:10:25.030 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: jwt
2026-01-14 09:10:25.031 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: vulnerabilities
2026-01-14 09:10:25.031 | INFO     | bugtrace.agents.jwt_agent:_setup_event_subscriptions:32 - [JWTAgent] Subscribed to 'auth_token_found' events.
2026-01-14 09:10:25.031 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üîç Starting token discovery for http://127.0.0.1:5090/jwt/level6
2026-01-14 09:10:25.086 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/jwt/level6
2026-01-14 09:10:25.652 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: No tokens found on target. Trying landing page: http://127.0.0.1:5090/
2026-01-14 09:10:25.652 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/
2026-01-14 09:10:26.233 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üéØ Discovered token at link_param: eyJ0eXAiOiJKV1QiLCJh...
2026-01-14 09:10:26.233 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Token Analysis: Alg=none, Claims=['role']
   ‚ùå FAILED - No JWT vuln detected (4.5s)

üîç Testing Level 6: Hard - Key injection
   URL: http://127.0.0.1:5090/jwt/level6
INFO     LLM Shift Success: Using     llm_client.py:189
         google/gemini-3-flash-previe                  
         w for JWT_AGENT                               
2026-01-14 09:10:29.778 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 1. Base64Url encode the header: `{"typ": "JWT", "alg": "none"}`.
2026-01-14 09:10:29.783 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:29.787 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:29.791 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:29.796 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:29.802 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:29.811 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:29.815 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:29.819 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:29.819 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 2. Base64Url encode the payload: `{"role": "admin"}`.
2026-01-14 09:10:29.819 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 3. Concatenate the two parts with a period (`.`).
2026-01-14 09:10:29.820 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 4. Append a final period (`.`) to represent the empty signature.
2026-01-14 09:10:29.820 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 5. Inject the resulting string into the `link_param` parameter of the target URL.
2026-01-14 09:10:30.822 | INFO     | bugtrace.agents.base:_load_system_prompt:73 - [JWTAgent] Loaded external prompt: system_prompts/jwt_agent.md
2026-01-14 09:10:30.822 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: jwt
2026-01-14 09:10:30.823 | INFO     | bugtrace.agents.base:_load_system_prompt:84 - [JWTAgent] Injected skill: vulnerabilities
2026-01-14 09:10:30.823 | INFO     | bugtrace.agents.jwt_agent:_setup_event_subscriptions:32 - [JWTAgent] Subscribed to 'auth_token_found' events.
2026-01-14 09:10:30.823 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üîç Starting token discovery for http://127.0.0.1:5090/jwt/level7
2026-01-14 09:10:30.879 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/jwt/level7
2026-01-14 09:10:31.439 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: No tokens found on target. Trying landing page: http://127.0.0.1:5090/
2026-01-14 09:10:31.439 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Scanning page: http://127.0.0.1:5090/
2026-01-14 09:10:32.024 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: üéØ Discovered token at link_param: eyJ0eXAiOiJKV1QiLCJh...
2026-01-14 09:10:32.024 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Token Analysis: Alg=none, Claims=['role']
   ‚ùå FAILED - No JWT vuln detected (4.8s)

üîç Testing Level 7: Hard - Advanced attacks (TARGET)
   URL: http://127.0.0.1:5090/jwt/level7
INFO     LLM Shift Success: Using     llm_client.py:189
         google/gemini-3-flash-previe                  
         w for JWT_AGENT                               
2026-01-14 09:10:35.569 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 1. Base64Url encode the header: `{"typ": "JWT", "alg": "none"}`.
2026-01-14 09:10:35.573 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:35.576 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:35.579 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:35.583 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:35.586 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:35.589 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:35.592 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:35.595 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Verification: Base Status=200 vs Forged Status=200
2026-01-14 09:10:35.595 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 2. Base64Url encode the payload: `{"role": "admin"}`.
2026-01-14 09:10:35.595 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 3. Concatenate the encoded header and payload with a dot (`.`).
2026-01-14 09:10:35.595 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 4. Append a trailing dot (`.`) to represent an empty signature.
2026-01-14 09:10:35.595 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 5. URL-encode the resulting string for use in the `link_param` URL parameter.
2026-01-14 09:10:35.595 | INFO     | bugtrace.agents.base:think:138 - [JWTAgent] THOUGHT: Executing step: 6. Submit the request to the target endpoint.
   ‚ùå FAILED - No JWT vuln detected (4.8s)
